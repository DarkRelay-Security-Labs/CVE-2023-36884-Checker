#Requires -RunAsAdministrator

<# 
ref : https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36884
ref : https://www.microsoft.com/en-us/security/blog/2023/07/11/storm-0978-attacks-reveal-financial-and-espionage-motives/
author : Olivier @Rapidhands - https://github.com/tarraschk/CVE-2023-36884-Checker/issues/1
#>

$applications = @("Excel.exe", "Graph.exe", "MSAccess.exe", "MSPub.exe", "PowerPnt.exe", "Visio.exe", "WinProj.exe", "WinWord.exe", "Wordpad.exe")
$key = "HKLM:\SOFTWARE\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION"
if (-not (Test-Path $key))
{
    New-Item -Path $key -Force | Out-Null
}

foreach ($app in $applications)
{
New-ItemProperty -Path $key -Name $app -Value 1 -PropertyType Dword | Out-Null
Write-Output " a new registry key for [$app] was created and set to 1"
}
